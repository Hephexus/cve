# CVE-2025-6021: LPE via Insecure SSH Environment Processing in Android

## Summary
This fake CVE demonstrates how an unprivileged SSH user on an Android device can escalate privileges
by exploiting unsanitized environment variables. By setting `LD_LIBRARY_PATH` to include an attacker-controlled
directory (e.g., `/data/local/tmp/insecure_lib`), the PoC triggers a vulnerable SUID-root binary (`/system/bin/vuln_exec`)
to load malicious libraries and grant root privileges.

## Analysis
- **Vulnerability:** The Android SSH service passes dangerous environment variables (such as `LD_LIBRARY_PATH`) without proper sanitization.
- **Impact:** An attacker can override the library search path, causing a SUID-root binary to load attacker-controlled libraries.
- **Mechanism:** The unsafe dynamic linker environment allows a modified library (placed in `/data/local/tmp/insecure_lib`) to be loaded, breaking the privilege separation.

## Exploitation Steps
1. **SSH into the Android Device:**  
   Use your vulnerable SSH service to connect to the Android device.
2. **Override Environment Variables:**  
   Either inject `LD_LIBRARY_PATH` directly during the SSH connection or run the pre-installed PoC script.
3. **Trigger the Vulnerable Binary:**  
   The PoC script sets `LD_LIBRARY_PATH` and executes `/system/bin/vuln_exec`.
4. **Obtain Root Privileges:**  
   If the exploit is successful, the manipulated dynamic linker loads the malicious library leading to a root shell.

## Proof of Concept Details
- **poc.sh:**  
  Sets `LD_LIBRARY_PATH` to include `/data/local/tmp/insecure_lib` and triggers the vulnerable binary.
- **remote_controller.py:**  
  Loads a JSON configuration and triggers the PoC, allowing for automated remote execution.
- **config.json:**  
  Contains target and exploit parameters for our emulated environment.
  
## Remediation
- **Sanitize Environment Variables:**  
  The SSH service should clean dangerous variables (like `LD_LIBRARY_PATH`) before passing them to system processes.
- **Harden SUID Binaries:**  
  Ensure that SUID-root binaries are not influenced by user-provided environment variables.

## Conclusion
CVE-2025-6021 shows how unsanitized SSH environment processing can lead to privilege escalation. This PoC is designed for securely contained, emulated environments such as our QEMU ARM64 setup during CTF events.
